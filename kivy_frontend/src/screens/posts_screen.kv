#:import dp kivy.metrics.dp

<PostsScreen>:
    AnchorLayout:
        anchor_x: "center"
        anchor_y: "center"
        MDBoxLayout:
            orientation: "vertical"
            padding: dp(20)
            spacing: dp(10)
            size_hint: None, 1
            width: dp(400)

            MDBoxLayout:
                size_hint: 1, None
                height: dp(50)
                MDLabel:
                    text: "MyStreet Posts"
                    font_style: "H5"
                    bold: True
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1

            MDBoxLayout:
                orientation: "vertical"
                size_hint: 1, None
                height: dp(200)
                spacing: dp(10)
                MDLabel:
                    text: "Create a Post"
                    bold: True
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                MDTextField:
                    id: title_input
                    hint_text: "Enter title"
                    multiline: False
                    size_hint: 1, None
                    height: dp(40)
                MDTextField:
                    id: text_input
                    multiline: True
                    hint_text: "Enter post text"
                    size_hint: 1, None
                    mode: "line"
                    height: dp(70)
                MDRaisedButton:
                    id: post_button
                    text: "Submit Post"
                    size_hint: 1, None
                    height: dp(100)
                    halign: "center"
                    md_bg_color: 1, 1, 1, 1
                    text_color: 0, 0, 0, 1
                    on_press: root.create_post()

            MDBoxLayout:
                orientation: "vertical"
                RecycleView:
                    id: posts_rv
                    viewclass: "PostItem"
                    data: root.posts_data
                    RecycleBoxLayout:
                        default_size: None, dp(170)
                        default_size_hint: 1, None
                        size_hint_y: None
                        height: self.minimum_height
                        orientation: "vertical"
<PostItem@BoxLayout>:
    post_id: ""
    like_count: 0
    comment_count: 0
    username: ""
    title: ""
    text: ""
    user_email: ""
    liked_by_user: root  
    orientation: "vertical"
    size_hint_y: None
    height: dp(170)
    padding: dp(5)
    spacing: dp(5)
    MDLabel:
        text: "[b]@{}[/b] [i][color=aaaaaa]{}[/color][/i]".format(root.username, root.user_email)
        markup: True
        size_hint_y: None
        height: dp(25)
        theme_text_color: "Custom"
        text_color: 1, 1, 1, 1
    MDLabel:
        text: root.title if root.title else "No Title"
        bold: True
        size_hint_y: None
        height: dp(25)
        theme_text_color: "Custom"
        text_color: 1, 1, 1, 1
    MDLabel:
        text: root.text if root.text else "No Content"
        size_hint_y: None
        height: dp(50)
        theme_text_color: "Custom"
        text_color: (200/255.0, 200/255.0, 200/255.0, 1)
    BoxLayout:
        orientation: "horizontal"
        size_hint_y: None
        height: dp(30)
        spacing: dp(5)
        MDIconButton:
            icon: "heart" if root.liked_by_user else "heart-outline"
            icon_size: "18sp"
            pos_hint: {"center_y": 0.5}
            on_release: app.root.get_screen("posts").toggle_like(root)
        MDLabel:
            text: str(root.like_count)
            size_hint: None, None
            size: dp(30), dp(30)
            halign: "center"
            valign: "middle"
            pos_hint: {"center_y": 0.5}
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1
        MDIconButton:
            icon: "comment-outline"
            icon_size: "18sp"
            pos_hint: {"center_y": 0.5}
            on_release: app.root.get_screen("posts").prompt_comment(root.post_id)
        MDLabel:
            text: str(root.comment_count)
            size_hint: None, None
            size: dp(30), dp(30)
            halign: "center"
            valign: "middle"
            pos_hint: {"center_y": 0.5}
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1
